---
title: Build Environment
description: Setting up the environment for contributing to Mosaic.
---

import { Steps, Badge, Card, CardGrid } from '@astrojs/starlight/components'

This document explains how to set up your development environment and build Mosaic from source. It describes required tools, supported platforms, dependency management, and platform-specific setup steps. You should follow this guide before attempting to configure or build the engine.

---

## Supported platforms and compilers

Mosaic targets **Windows**, **Linux**, **Web**, and **Android**. You may ignore setup steps for platforms you do not intend to build.

On Windows, Visual Studio 2022 provides the most reliable CMake integration and debugging experience. The default compiler is MSVC, although Clang is also supported. On Linux and Web targets, Clang is the preferred compiler. Web builds rely on Emscripten.

---

## Environment setup

### Prerequisites

Install the following tools before configuring Mosaic:

* **CMake** 3.25 or later
* **Git** with submodule support
* **Python** 3 (required by Emscripten and build scripts)
* A **C++23-compliant compiler**

  * MSVC 17.13 Preview 2 or later
  * Clang 13 or later
  * GCC 14 or later

### Install vcpkg

Mosaic uses **vcpkg in manifest mode** to manage most third-party dependencies. You must install vcpkg separately, but you do not need to integrate it globally.

<Steps>

1. Clone the vcpkg repository.

   ```bash
   git clone https://github.com/microsoft/vcpkg.git
   ```

2. Bootstrap vcpkg for your platform.

   ```bash
   ./vcpkg/bootstrap-vcpkg.sh
   ```

   On Windows, run `.\bootstrap-vcpkg.bat` instead.

3. If required, set the `VCPKG_ROOT` environment variable to the vcpkg directory.

</Steps>

---

## Platform-specific setup

### Windows (Visual Studio 2022)

Install **Visual Studio 2022** with the following components:

* Desktop development with C++
* C++ CMake tools for Windows
* MSVC v143 toolset or later
* Windows 10 or Windows 11 SDK

Visual Studio provides first-class CMake preset support and simplifies debugging large native codebases.

### Linux

Install the required system packages for building and running Mosaic:

```bash
sudo apt update
sudo apt install \
  build-essential \
  cmake \
  git \
  ninja-build \
  python3 \
  python3-pip \
  libx11-dev \
  libxcursor-dev \
  libxrandr-dev \
  libxi-dev \
  libgl1-mesa-dev \
  libvulkan-dev
```

You may need additional packages depending on your distribution and window system.

### Web (Emscripten) <Badge text="Experimental" variant="danger" />

Mosaic uses **Emscripten** to target WebAssembly and WebGPU.

<Steps>

1. Install the Emscripten SDK.

   ```bash
   git clone https://github.com/emscripten-core/emsdk.git
   cd emsdk
   ./emsdk install latest
   ./emsdk activate latest
   ```

2. Load the Emscripten environment.

   ```bash
   source ./emsdk_env.sh
   ```

   On Windows, use `emsdk_env.bat`.

3. Verify that `emcc` is available in your `PATH` before running CMake.

</Steps>

### Android <Badge text="Experimental" variant="danger" />

<Steps>

1. Install **Android Studio**.

2. Open the SDK Manager and install:

   * Android NDK r23 or newer
   * CMake and LLDB
   * Android SDK tools for API level 24 or later

3. Set the `ANDROID_NDK_HOME` environment variable to the NDK installation path.

</Steps>

---

## Build instructions

Follow these steps to build Mosaic from source.

<Steps>

1. Clone the repository and initialize all submodules.

   ```bash
   git clone --recurse-submodules https://github.com/WilliamKarolDiCioccio/mosaic
   ```

2. Select a CMake **configure preset** appropriate for your platform.

3. Select a corresponding **build preset** and build the project. The vcpkg toolchain installs dependencies automatically.

</Steps>

At this point, the engine, editor, and test targets are available for your platform.

:::caution
Mosaic enables Web Workers using the `-pthread` flag to preserve compatibility with native threading code. In some cases, additional flags are required to enable atomic and bulk memory features.

If the build fails with missing atomic support, patch the following file:

```
out/build/emscripten-${PROFILE}/_deps/emdawnwebgpu-src/emdawnwebgpu.port.py
```

Add the required flags manually:

```diff lang="py"
flags = ['-g', '-std=c++17', '-fno-exceptions']
+flags += ['-matomics', '-mbulk-memory']
flags += compute_library_compile_flags(settings)
```

This change enables compatibility with multi-threaded WebAssembly targets.
:::
